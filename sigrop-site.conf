<VirtualHost *:80>
    ServerName sigrop.site
    ServerAlias www.sigrop.site

    # Cấu hình proxy
    ProxyRequests Off
    ProxyPreserveHost On
    AllowEncodedSlashes NoDecode
    
    # Tăng giới hạn kích thước request để cho phép payload phức tạp
    LimitRequestFieldSize 32768
    LimitRequestLine 32768
    
    # Cấu hình proxy các request đến container Docker của Node.js
    # Xác định rằng cổng 8080 là nơi ứng dụng Node.js đang chạy
    ProxyPass / http://127.0.0.1:8080/ nocanon
    ProxyPassReverse / http://127.0.0.1:8080/
    
    # Thêm header để xác định nguồn thực
    RequestHeader set X-Forwarded-Proto "http"
    RequestHeader set X-Real-IP %{REMOTE_ADDR}s
    
    # Đảm bảo timeout đủ lâu để xử lý request phức tạp
    ProxyTimeout 300
    Timeout 300

    ErrorLog ${APACHE_LOG_DIR}/sigrop-error.log
    CustomLog ${APACHE_LOG_DIR}/sigrop-access.log combined
</VirtualHost>
